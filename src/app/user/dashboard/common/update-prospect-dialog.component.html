<div class="dialog-wrapper">
  <!-- Header -->
  <div class="dialog-header">
    <div class="dialog-header-left">
      <div class="dialog-icon-wrapper">
        <mat-icon>contact_phone</mat-icon>
      </div>
      <div>
        <h2 class="dialog-title">Registrar Contacto</h2>
        <p class="dialog-subtitle">Selecciona el resultado de la gestion</p>
      </div>
    </div>
    <button mat-icon-button class="close-btn" (click)="onCancel()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Prospect Info Card -->
  <div class="prospect-info-card">
    <div class="prospect-avatar">{{ getInitials() }}</div>
    <div class="prospect-details">
      <span class="prospect-name">{{ data.name }}</span>
      <div class="prospect-phone">
        <mat-icon>phone</mat-icon>
        <span>{{ data.phone }}</span>
      </div>
    </div>
    <span class="current-estado" *ngIf="data.estadoActual">
      Estado actual: {{ data.estadoActual }}
    </span>
  </div>

  <!-- Estado Selector -->
  <div class="dialog-body">
    <div class="form-section">
      <div class="form-section-label">
        <mat-icon>flag</mat-icon>
        <span>Resultado de la gestion</span>
      </div>
      <div class="estado-grid">
        <button
          *ngFor="let option of estadoOptions"
          class="estado-option"
          [class.estado-selected]="estadoSeleccionado === option.value"
          [ngClass]="estadoSeleccionado === option.value ? option.colorClass + '-active' : ''"
          (click)="selectEstado(option.value)">
          <mat-icon class="estado-option-icon" [ngClass]="option.colorClass">{{ option.icon }}</mat-icon>
          <span class="estado-option-label">{{ option.label }}</span>
          <span class="estado-option-desc">{{ option.description }}</span>
          <div class="terminal-badge" *ngIf="isTerminal(option.value)">Final</div>
        </button>
      </div>
    </div>

    <!-- Agenda Section (conditional) -->
    <div class="form-section agenda-section" *ngIf="estadoSeleccionado === 'AGENDADO'">
      <div class="form-section-label">
        <mat-icon>schedule</mat-icon>
        <span>Fecha y hora de la agenda</span>
      </div>
      <div class="agenda-inputs">
        <div class="agenda-field">
          <label class="input-label">Fecha</label>
          <input type="date" class="native-input" [(ngModel)]="fechaAgenda">
        </div>
        <div class="agenda-field">
          <label class="input-label">Hora</label>
          <input type="time" class="native-input" [(ngModel)]="horaAgenda">
        </div>
      </div>
    </div>

    <!-- Comment Section -->
    <div class="form-section">
      <div class="form-section-label">
        <mat-icon>comment</mat-icon>
        <span>Comentario (opcional)</span>
      </div>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Escribe un comentario...</mat-label>
        <textarea matInput [(ngModel)]="comentario" rows="3"></textarea>
      </mat-form-field>
    </div>
  </div>

  <!-- Actions -->
  <div class="dialog-actions">
    <button mat-stroked-button class="cancel-btn" (click)="onCancel()">
      Cancelar
    </button>
    <button mat-flat-button class="save-btn" (click)="onConfirm()" [disabled]="!isFormValid">
      <mat-icon>save</mat-icon>
      <span>Registrar Contacto</span>
    </button>
  </div>
</div>
