<div class="upload-container">
  <!-- Header Section -->
  <div class="upload-header">
    <div class="header-content">
      <div class="header-left">
        <div class="header-icon-wrapper">
          <mat-icon>cloud_upload</mat-icon>
        </div>
        <div>
          <h1 class="page-title">Cargar Archivo Excel</h1>
          <p class="page-subtitle">Importa prospectos al sistema desde un archivo Excel</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Section -->
  <div class="upload-section">
    <div class="upload-card">
      <!-- Drop Zone -->
      <div
        class="drop-zone"
        [class.drag-over]="isDragOver"
        [class.has-file]="selectedFile"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="triggerFileInput()">

        <div class="drop-zone-content" *ngIf="!selectedFile">
          <div class="drop-icon-wrapper">
            <mat-icon class="drop-icon">file_upload</mat-icon>
          </div>
          <div class="drop-text">
            <h3>Arrastra tu archivo aqui</h3>
            <p>o <span class="link-text">haz clic para seleccionar</span></p>
          </div>
          <div class="file-types">
            <span class="file-type-badge">
              <mat-icon>table_chart</mat-icon>
              XLSX
            </span>
            <span class="file-type-badge">
              <mat-icon>table_chart</mat-icon>
              XLS
            </span>
          </div>
        </div>

        <!-- Selected File -->
        <div class="selected-file-content" *ngIf="selectedFile">
          <div class="file-icon-wrapper">
            <mat-icon>description</mat-icon>
          </div>
          <div class="file-details">
            <span class="file-name">{{ selectedFile.name }}</span>
            <span class="file-size">{{ formatFileSize(selectedFile.size) }}</span>
          </div>
          <button
            mat-icon-button
            (click)="removeFile(); $event.stopPropagation()"
            class="remove-btn"
            [disabled]="isUploading"
            matTooltip="Quitar archivo">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      </div>

      <!-- Hidden File Input -->
      <input
        #fileInput
        type="file"
        (change)="onFileSelected($event)"
        accept=".xlsx,.xls"
        hidden>

      <!-- Upload Button -->
      <div class="action-buttons">
        <button
          mat-flat-button
          class="upload-btn"
          (click)="uploadFile()"
          [disabled]="!selectedFile || isUploading">
          <mat-icon *ngIf="!isUploading">cloud_upload</mat-icon>
          <mat-spinner *ngIf="isUploading" diameter="20"></mat-spinner>
          <span *ngIf="!isUploading">Subir Archivo</span>
          <span *ngIf="isUploading">Subiendo...</span>
        </button>
      </div>
    </div>

    <!-- Info Panel -->
    <div class="info-panel">
      <div class="info-panel-header">
        <mat-icon>table_chart</mat-icon>
        <span>Formato del Excel</span>
      </div>
      <div class="columns-table-wrapper">
        <table class="columns-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Columna</th>
              <th>Requerido</th>
              <th>Formato</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="col-number">1</td>
              <td class="col-name">Nombre</td>
              <td><span class="badge badge-required">Obligatorio</span></td>
              <td class="col-format">No vacio</td>
            </tr>
            <tr>
              <td class="col-number">2</td>
              <td class="col-name">Apellido</td>
              <td><span class="badge badge-optional">Opcional</span></td>
              <td class="col-format">â€”</td>
            </tr>
            <tr>
              <td class="col-number">3</td>
              <td class="col-name">Campania</td>
              <td><span class="badge badge-optional">Opcional</span></td>
              <td class="col-format">Se crea si no existe</td>
            </tr>
            <tr>
              <td class="col-number">4</td>
              <td class="col-name">Doc. Identidad</td>
              <td><span class="badge badge-optional">Opcional</span></td>
              <td class="col-format">8 digitos</td>
            </tr>
            <tr>
              <td class="col-number">5</td>
              <td class="col-name">Celular</td>
              <td><span class="badge badge-required">Obligatorio</span></td>
              <td class="col-format">9 digitos exactos</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="columns-table-note">
        <mat-icon>info_outline</mat-icon>
        <span>La primera fila se toma como encabezado y se omite al importar.</span>
      </div>
    </div>
  </div>
</div>
